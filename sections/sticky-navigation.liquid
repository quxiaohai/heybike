<sticky-navigation class="flex z-20 bottom-0 right-0 h-full {% if section.settings.hidden_sticky_nav %} hidden-sticky-nav {% endif %}">
	<div class="page-width flex justify-between w-full tems-center">
		<ul class="sticky-navigation_btns flex gap-8">
			{% for block in section.blocks %}
			<li class="sticky-navigation_button {% if forloop.first %} active {% endif %}"><a href="#{{block.settings.link_url}}">{{block.settings.link_text}}</a></li> 
			{%- endfor -%}
		</ul>
		{%- if product.available -%}
		{%- assign sticky_product_form_id = 'StickyProductForm-' | append: section.id -%}
		{%- form 'product',
			product,
			id: sticky_product_form_id,
			novalidate: 'novalidate',
			data-type: 'add-to-cart-form',
			class: 'product-form grid gap-6',
			is: 'product-form'
		-%}
			<input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" disabled />
			{%- assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media -%}
			<div class="sticky-buy-button__variant{% if featured_media == blank %} no-image{% endif %} grid items-center gap-4">
				{%- if featured_media != blank -%}
					<sticky-variant-media class="hidden md:block media media--adapt relative overflow-hidden" widths="80,160" form="{{ product_form_id }}">
						{{- featured_media | image_url: width: featured_media.width | image_tag: loading: 'lazy', sizes: '80px', widths: '80,160', is: 'lazy-image' -}}
					</sticky-variant-media>
				{%- endif -%}

				<div class="grid gap-2">
					<div class="grid gap-1">
						<p class="text-base font-bold leading-tight">{{ product.title }}</p>
						{%- unless product.has_only_default_variant -%}
                          {% if section.settings.enable_show_variant %}
							<sticky-variant-title class="block text-xs text-opacity leading-tight" form="{{ product_form_id }}">
								{{- product.selected_or_first_available_variant.title -}}
							</sticky-variant-title>
                          {% endif %}
						{%- endunless -%}
					</div>
				</div>

				{%- liquid
					assign check_against_inventory = true
					if product.selected_or_first_available_variant.inventory_management != 'shopify' or  product.selected_or_first_available_variant.inventory_policy == 'continue'
						assign check_against_inventory = false
					endif
					if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
						assign quantity_rule_soldout = true
					endif
				-%}
				<button
					type="submit"
					name="add"
					class="button button--primary"
					is="hover-button"
                    aria-controls="Quickview-{{ section.id }}-{{ product.id }}" aria-expanded="false" 
					{%- if product.selected_or_first_available_variant.available == false or quantity_rule_soldout %} disabled{% endif -%}
					{%- if product.template_suffix == 'pre-order' %} data-pre-order="true"{% endif -%}
				>
					<span class="btn-fill" data-fill></span>
					<span class="btn-text">
						{%- liquid
							if product.selected_or_first_available_variant.available == false or quantity_rule_soldout
								echo 'products.product.sold_out' | t
							elsif product.template_suffix != 'pre-order'
								echo 'products.product.add_to_cart' | t
							else
								echo 'products.product.pre_order' | t
							endif
						-%}
                        {% if section.settings.enable_show_price %}
						<span class="relative">&nbsp;&nbsp;-&nbsp;&nbsp;</span>
						<div id="StickyPrice-{{ section.id }}" class="relative">
							{%- render 'product-price', product: product, use_variant: true, class: 'flex items-center gap-2 lg:gap-1d5' -%}
						</div>
                        {% endif %}
					</span>
				</button>
                 <quick-view id="Quickview-{{ section.id }}-{{ product.id }}" class="quick-view x-modal drawer z-30 fixed bottom-0 left-0 h-full w-full pointer-events-none" data-product-url="{{ product.url }}" role="dialog" aria-label="{{ 'products.product.choose_product_options' | t: product_name: product.title | escape }}" aria-modal="true">
                    <overlay-element class="overlay fixed-modal invisible opacity-0 fixed bottom-0 left-0 w-full h-screen pointer-events-none" aria-controls="Quickview-{{ section.id }}-{{ product.id }}" aria-expanded="false"></overlay-element>
                    <div class="drawer__inner z-10 absolute top-0 flex flex-col w-full h-full overflow-hidden">
                      <gesture-element class="drawer__header flex items-center justify-between opacity-0 invisible relative">
                        <button class="button button--secondary button--close drawer__close z-1 absolute top-0 right-0 flex items-center justify-center opacity-0" type="button" is="hover-button" aria-controls="Quickview-{{ section.id }}-{{ product.id }}" aria-expanded="false" aria-label="{{ 'general.accessibility.close' | t | escape }}">
                          <span class="btn-fill" data-fill></span>
                          <span class="btn-text">
                            {%- render 'icon', icon: 'close', size: 'sm' -%}
                          </span>
                        </button>
                      </gesture-element>
                      <div class="quick-view__content drawer__content opacity-0 invisible flex flex-col h-full grow shrink"></div>
                    </div>
                  </quick-view>
			</div>
			<div class="product-form__error-message alert alert--error text-sm font-medium leading-tight" role="alert" hidden></div>
		{%- endform -%}
		{%- endif -%}
	</div>
</sticky-navigation>

{{ 'sticky-navigation.css' | asset_url | stylesheet_tag }}

{% schema %}
  {
    "name": "Sticky Nav",
    "class": "sticky-navigation",
    "settings": [
      {
        "type": "checkbox",
        "id": "enable_show_price",
        "default": false,
        "label": "Enable show product price"
      },
      {
        "type": "checkbox",
        "id": "enable_show_variant",
        "default": false,
        "label": "Enable show product variant"
      },
      {
        "type": "checkbox",
        "id": "hidden_sticky_nav",
        "default": true,
        "label": "Default hidden sticky nav"
      }
    ],
    "blocks": [
      {
        "type": "url",
        "name": "Tab Item",
        "settings": [
          {
            "id": "link_text",
            "type": "text",
            "label": "Tab title"
          },
          {
            "id": "link_url",
            "type": "text",
            "label": "Section id"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Sticky Nav"
      }
    ]
  }
{% endschema %}


