{% comment %}
  Adjusted by CLEARgo
{% endcomment %}

{% style %}
  #shopify-section-{{ section.id }} {
    --section-padding-top: {{ section.settings.padding_top }}px;
    --section-padding-bottom: {{ section.settings.padding_bottom }}px;
    {%- render 'section-variables', section: section -%}
  }

  .section-{{ section.id }} .page-width { 
    padding-inline: 0; 
  }

  .section-{{ section.id }} .ui-draggable-handle {
    touch-action: pan-x !important;
  }

  .section-{{ section.id }} .title-wrapper { 
    width: 100%; 
    max-width: 1440px; 
    margin-inline: auto; 
    padding: 0 20px; 
    /* padding: 0 var(--page-padding); */
  }

  .section-{{ section.id }} slider-element { 
    width: 100%; 
    display: block; 
    padding: 0 calc((100% - 1400px) / 2); 
    overflow-x: auto; 
  }

  .section-{{ section.id }} .blog-collage { 
    width: fit-content; 
    max-width: none; 
    position: relative; 
    display: flex; 
    /* padding: 0 var(--page-padding); */
    grid-template-rows: unset; 
    grid-template-columns: unset; 
    overflow: visible; 
    cursor: grab; 

    {% if section.settings.gap != blank %}
      gap: calc({{ section.settings.gap }}vw / 19.2); 
    {% endif %}
  }

  .section-{{ section.id }} .blog-collage .article-card { 
    width: calc(1045vw / 19.2); 
    min-height: calc(680vw / 19.2); 
    gap: calc(50vw / 19.2); 
    overflow: hidden; 

    {% if section.settings.card_bg != blank %}
      background-color: {{ section.settings.card_bg }}; 
    {% endif %}
    {% if section.settings.card_radius != blank %}
      border-radius: calc({{ section.settings.card_radius }}vw / 19.2); 
    {% endif %}
    {% if section.settings.card_padding != blank %}
      padding: calc({{ section.settings.card_padding }}vw / 19.2); 
    {% endif %}
  }

  .section-{{ section.id }} .blog-collage .article-card__media { 
    overflow: hidden; 

    {% if section.settings.image_radius != blank %}
      border-radius: calc({{ section.settings.image_radius }}vw / 19.2); 
    {% endif %}
  }

  .section-{{ section.id }} .article-card__content { 
    height: 100%; 
    flex-direction: column; 
    justify-content: space-between; 
    padding: calc(60vw / 19.2) calc(30vw / 19.2) calc(10vw / 19.2) calc(30vw / 19.2); 
  }

  .section-{{ section.id }} .blog-collage .article-card__title { 
    margin-bottom: calc(20vw / 19.2); 
  }

  .section-{{ section.id }} .article-card__content p {
    color: var(--color-grey-2); 
  }

  .section-{{ section.id }} .blog-collage .button-with-url { 
    width: fit-content; 
    margin-top: calc(36vw / 19.2); 
    padding: calc(16vw / 19.2) calc(24vw / 19.2); 
  }

  .section-{{ section.id }} .article-card__footer { 
    gap: calc(16vw / 19.2); 
    align-items: center; 
    margin-top: auto; 
  }

  .section-{{ section.id }} .article-card__footer .author-icon { 
    width: calc(64vw / 19.2); 
    height: calc(64vw / 19.2); 
    aspect-ratio: 1; 
    border-radius: 50%; 
  }

  .section-{{ section.id }} .article-card__footer .article-card-footer-inner { 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
  }

  .section-{{ section.id }} .article-card__footer .author { 
    font-size: calc(20vw / 19.2); 
    margin-bottom: calc(4vw / 19.2); 
  }

  .section-{{ section.id }} .article-card__footer time { 
    color: var(--color-grey-2); 
  }

  .section-{{ section.id }} .article-card__desc, 
  .section-{{ section.id }} .article-card__desc * {
    color: var(--color-grey-2); 
    line-height: normal; 
    font-size: .875rem; 
  }

  .section-{{ section.id }} .article-card__desc.mobile {
    display: none; 
  }

  /* Responsive */
  /* Mobile */
  @media (max-width: 767px) { 
    .section-{{ section.id }} .title-wrapper { 
      padding: 0 12.5px; 
    }

    .section-{{ section.id }} .page-width { 
      padding-inline: unset; 
    }

    .section-{{ section.id }} slider-element { 
      width: 100%; 
      margin-left: 0; 
      padding: 0; 
      overflow-x: auto; 
    }

    .section-{{ section.id }} .blog-collage { 
      padding: 0 12.5px; 

      {% if section.settings.gap_mobile != blank %}
        gap: {{ section.settings.gap_mobile }}px; 
      {% endif %}
    }

    .section-{{ section.id }} .blog-collage .article-card { 
      width: 70vw; 
      height: auto; 
      flex-direction: column-reverse; 
      justify-content: space-between; 
      gap: 16px; 
      padding: 20px; 

      {% if section.settings.card_radius != blank %}
        border-radius: {{ section.settings.card_radius }}px; 
      {% endif %}
    }

    .section-{{ section.id }} .article-card__image { 
      width: 100%; 
      height: 100%; 
      aspect-ratio: 414 / 450; 
    }

    .section-{{ section.id }} .blog-collage .article-card__media {
      overflow: unset; 
    }

    .section-{{ section.id }} .blog-collage .article-card__media img { 
      {% if section.settings.image_radius != blank %}
        border-radius: {{ section.settings.image_radius }}px; 
      {% endif %}
    }

    .section-{{ section.id }} .article-card__content { 
      padding: 0; 
    }

    .section-{{ section.id }} .blog-collage .button-with-url { 
      display: none; 
    }
    
    .section-{{ section.id }} .article-card__footer { 
      gap: 8px; 
      margin-top: 32px; 
    }

    .section-{{ section.id }} .article-card__footer .author-icon { 
      width: 32px; 
      height: 32px; 
    }

    .section-{{ section.id }} .article-card__footer .author { 
      font-size: 10px; 
      margin-bottom: 0; 
    }

    .section-{{ section.id }} .article-card__footer .date { 
      line-height: inherit; 
    }

    .section-{{ section.id }} .article-card__desc {
      display: none; 
    }
  
    .section-{{ section.id }} .article-card__desc.mobile {
      display: block; 
    }
  }

  /* Tablet */
  @media (min-width: 768px) and (max-width: 1366px) { 
  .section-{{ section.id }} .title-wrapper { 
    /* padding: 0 var(--page-padding); */
  }

  .section-{{ section.id }} slider-element { 
    width: 100%; 
    margin-left: 0;
    padding: 0 20px; 
  }

  .section-{{ section.id }} .page-width { 
    padding-inline: unset; 
  }

  .section-{{ section.id }} .blog-collage { 
      {% if section.settings.gap != blank %}
        gap: calc({{ section.settings.gap }}vw / 13.66); 
      {% endif %}
    }

    .section-{{ section.id }} .blog-collage .article-card { 
      width: calc(1045vw / 13.66); 
      min-height: calc(680vw / 13.66); 
      gap: calc(50vw / 13.66); 

      {% if section.settings.card_radius != blank %}
        border-radius: calc({{ section.settings.card_radius }}vw / 13.66); 
      {% endif %}
      {% if section.settings.card_padding != blank %}
        padding: calc({{ section.settings.card_padding }}vw / 13.66); 
      {% endif %}
    }

    .section-{{ section.id }} .blog-collage .article-card__media { 
      {% if section.settings.image_radius != blank %}
        border-radius: calc({{ section.settings.image_radius }}vw / 13.66); 
      {% endif %}
    }

    .section-{{ section.id }} .article-card__content { 
      padding: calc(60vw / 13.66) calc(30vw / 13.66) calc(10vw / 13.66) calc(30vw / 13.66); 
    }

    .section-{{ section.id }} .blog-collage .article-card__title { 
      margin-bottom: calc(20vw / 13.66); 
    }

    .section-{{ section.id }} .blog-collage .button-with-url { 
      margin-top: calc(36vw / 13.66); 
      padding: calc(16vw / 13.66) calc(24vw / 13.66); 
    }

    .section-{{ section.id }} .article-card__footer { 
      gap: calc(16vw / 13.66); 
    }

    .section-{{ section.id }} .author-icon { 
      width: calc(64vw / 13.66); 
      height: calc(64vw / 13.66); 
    }

    .section-{{ section.id }} .article-card__footer .author { 
      font-size: calc(20vw / 13.66); 
      margin-bottom: calc(4vw / 13.66); 
    }
  }

  /* Desktop */
  @media (min-width: 1920px) { 
    .section-{{ section.id }} .blog-collage { 
      {% if section.settings.gap != blank %}
        gap: {{ section.settings.gap }}px; 
      {% endif %}
    }
    
    .section-{{ section.id }} .blog-collage .article-card { 
      width: 1045px; 
      min-height: 680px; 
      gap: 50px; 

      {% if section.settings.card_radius != blank %}
        border-radius: {{ section.settings.card_radius }}px; 
      {% endif %}
      {% if section.settings.card_padding != blank %}
        padding: {{ section.settings.card_padding }}px; 
      {% endif %}
    }
    
    .section-{{ section.id }} .blog-collage .article-card__media { 
      {% if section.settings.image_radius != blank %}
        border-radius: {{ section.settings.image_radius }}px; 
      {% endif %}
    }

    .section-{{ section.id }} .article-card__content { 
      padding: 60px 30px 10px 30px; 
    }
    
    .section-{{ section.id }} .blog-collage .article-card__title { 
      margin-bottom: 20px; 
    }
    
    .section-{{ section.id }} .blog-collage .button-with-url { 
      margin-top: 36px; 
      padding: 16px 24px; 
    }

    .section-{{ section.id }} .article-card__footer { 
      gap: 16px; 
    }

    .section-{{ section.id }} .author-icon { 
      width: 64px; 
      height: 64px; 
    }

    .section-{{ section.id }} .article-card__footer .author { 
      font-size: 20px; 
      margin-bottom: 4px; 
    }
  }
{% endstyle %}

{%- if section.index > 2 -%}
  <link rel="stylesheet" href="{{ 'blog.css' | asset_url }}" media="print" onload="this.media='all'">
  <noscript>{{ 'blog.css' | asset_url | stylesheet_tag }}</noscript>
{%- else -%}
  {{ 'blog.css' | asset_url | stylesheet_tag }}
{%- endif -%}

{%- assign blog = section.settings.blog -%}
<div class="section-{{ section.id }} section section--padding{% if section.settings.divider %} section--divider{% endif %}{% if section.settings.rounded %} section--rounded relative{% endif %}">
  <div class="{% comment %}page-width{% if section.settings.full_width %} page-width--full{% endif %}{% endcomment %} relative">
    {%- capture view_all -%}
      {%- if section.settings.show_view_all and blog != blank and section.settings.post_limit < blog.articles_count -%}
        <a class="button button--primary icon-with-text button-with-url" href="{{ blog.url }}" is="hover-link">
          <span class="btn-fill" data-fill></span>
          <span class="btn-text">
            {{ 'sections.blog_posts.view_all' | t }}
          </span>
        </a>
      {%- endif -%}
    {%- endcapture -%}
    {%- render 'section-heading', section: section, section_button: view_all -%}

    {%- if blog != blank -%}
      {%- liquid
        assign articles_count = blog.articles_count
        if section.settings.post_limit < blog.articles_count
          assign articles_count = section.settings.post_limit
        endif
      -%}
      <slider-element class="grid slider" selector=".card-grid>.card">
        <div class="blog-grid blog-collage with-only{{ articles_count }} card-grid mobile:card-grid--1 grid">
          {%- for article in blog.articles limit: section.settings.post_limit -%}
            {% comment %}
              {%- if forloop.first -%}
                {%- capture sizes -%}(max-width: 1023px) 100vw, calc(min(100vw, {{ settings.page_width }}px) * 0.65){%- endcapture -%}
              {%- else -%}
                {%- capture sizes -%}(max-width: 639px) 100vw, (max-width: 1023px) calc(100vw / 2 - 40px), (max-width: 1535px) calc(min(100vw, {{ settings.page_width }}px) / 3 - 40px), calc(min(100vw, {{ settings.page_width }}px) / 3 - 80px){%- endcapture -%}
              {%- endif -%}
            {% endcomment %}

            {%- render 'cg_article-card',
              article: article,
              blog: blog,
              sizes: sizes,
              image_ratio: section.settings.image_ratio,
              show_tags: section.settings.show_tags,
              show_date: section.settings.show_date,
              show_author: section.settings.show_author,
              show_comments: section.settings.show_comments,
              show_excerpt: section.settings.show_excerpt,
            -%}
          {%- endfor -%}
        </div>
      </slider-element>
    {%- else -%}
      <div class="rte">
        {{- 'onboarding.no_content' | t -}}
      </div>
    {%- endif -%}
  </div>
</div>

<script>
  /* Draggable interactive effect */
  function setupDraggable() { 
    if ($(window).width() > 767) { 
      /* Assign on desktop and tablet */
      $(".section-{{ section.id }} .blog-collage").draggable({ 
        axis: 'x',
        scroll: false,
        drag: function (event, ui) {
          var containerWidth = $(".section-{{ section.id }} slider-element").width();
          var draggableWidth = $(".section-{{ section.id }} .blog-collage").outerWidth();
          var maxLeftPosition = containerWidth - draggableWidth;
          ui.position.left = Math.min(0, Math.max(maxLeftPosition, ui.position.left));
        }
      });
    } else { 
      /* Remove from mobile */
      $(".section-{{ section.id }} .blog-collage").draggable("destroy"); 
    }
  }

  $(document).ready(function () { 
    /* Trigger when init */
    setupDraggable(); 
    
    /* Trigger when resize */
    $(window).on('resize', setupDraggable); 
  });
</script>

{% schema %}
{
  "name": "CG Blog Posts Collage", 
  "tag": "section", 
  "class": "cg-blog-posts-collage", 
  "settings": [
    {
      "id": "blog",
      "type": "blog",
      "label": "t:sections.blog-posts.settings.blog.label"
    },
    {
      "type": "range",
      "id": "post_limit",
      "label": "t:sections.blog-posts.settings.post_limit.label",
      "default": 4,
      "min": 2,
      "max": 4,
      "step": 1
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "t:sections.blog-posts.settings.show_view_all.label",
      "info": "t:sections.blog-posts.settings.show_view_all.info",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header__post.content"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.global.settings.image_ratio.options__1.label"
        },
        {
          "value": "square",
          "label": "t:sections.global.settings.image_ratio.options__2.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.global.settings.image_ratio.options__3.label"
        },
        {
          "value": "landscape",
          "label": "t:sections.global.settings.image_ratio.options__4.label"
        },
        {
          "value": "wide",
          "label": "t:sections.global.settings.image_ratio.options__5.label"
        }
      ],
      "default": "landscape",
      "label": "t:sections.global.settings.image_ratio.label"
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "t:sections.main-blog.settings.show_tags.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "t:sections.main-blog.settings.show_date.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_comments",
      "label": "t:sections.main-blog.settings.show_comments.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "t:sections.main-blog.settings.show_author.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "t:sections.main-blog.settings.show_excerpt.label",
      "default": false
    },
    {
      "type": "paragraph",
      "content": "t:sections.main-blog.settings.paragraph.content"
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header__heading.content"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "t:sections.global.settings.heading.label",
      "default": "Blog posts"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "title-sm",
          "label": "t:sections.global.settings.heading_size.options__1.label"
        },
        {
          "value": "title-md",
          "label": "t:sections.global.settings.heading_size.options__2.label"
        },
        {
          "value": "title-lg tracking-heading",
          "label": "t:sections.global.settings.heading_size.options__3.label"
        },
        {
          "value": "title-xl tracking-heading",
          "label": "t:sections.global.settings.heading_size.options__4.label"
        }
      ],
      "default": "title-md",
      "label": "t:sections.global.settings.heading_size.label"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "t:sections.global.settings.heading_alignment.label",
      "options": [
        {
          "value": "text-left md:items-end md:flex-row",
          "label": "t:sections.global.settings.heading_alignment.options__1.label"
        },
        {
          "value": "text-center md:items-center",
          "label": "t:sections.global.settings.heading_alignment.options__2.label"
        },
        {
          "value": "text-right md:items-end md:flex-row-reverse",
          "label": "t:sections.global.settings.heading_alignment.options__3.label"
        }
      ],
      "default": "text-left md:items-end md:flex-row"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "options": [
        {
          "value": "h1",
          "label": "t:sections.global.settings.heading_tag.options__1.label"
        },
        {
          "value": "h2",
          "label": "t:sections.global.settings.heading_tag.options__2.label"
        },
        {
          "value": "h3",
          "label": "t:sections.global.settings.heading_tag.options__3.label"
        },
        {
          "value": "h4",
          "label": "t:sections.global.settings.heading_tag.options__4.label"
        },
        {
          "value": "h5",
          "label": "t:sections.global.settings.heading_tag.options__5.label"
        },
        {
          "value": "h6",
          "label": "t:sections.global.settings.heading_tag.options__6.label"
        },
        {
          "value": "div",
          "label": "t:sections.global.settings.heading_tag.options__7.label"
        },
        {
          "value": "span",
          "label": "t:sections.global.settings.heading_tag.options__8.label"
        },
        {
          "value": "p",
          "label": "t:sections.global.settings.heading_tag.options__9.label"
        }
      ],
      "default": "h2",
      "label": "t:sections.global.settings.heading_tag.label",
      "info": "t:sections.global.settings.heading_tag.info"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "t:sections.global.settings.subheading.label"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "t:sections.global.settings.description.label"
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header__highlight.content",
      "info": "t:sections.global.settings.header__highlight.info"
    },
    {
      "type": "select",
      "id": "highlighted_text",
      "options": [
        {
          "value": "none",
          "label": "t:sections.global.settings.highlighted_text.options__1.label"
        },
        {
          "value": "text",
          "label": "t:sections.global.settings.highlighted_text.options__2.label"
        },
        {
          "value": "full_text",
          "label": "t:sections.global.settings.highlighted_text.options__3.label"
        },
        {
          "value": "half_text",
          "label": "t:sections.global.settings.highlighted_text.options__4.label"
        },
        {
          "value": "underline",
          "label": "t:sections.global.settings.highlighted_text.options__5.label"
        },
        {
          "value": "stencil",
          "label": "t:sections.global.settings.highlighted_text.options__6.label"
        },
        {
          "value": "scribble",
          "label": "t:sections.global.settings.highlighted_text.options__7.label"
        }
      ],
      "default": "none",
      "label": "t:sections.global.settings.highlighted_text.label"
    },
    {
      "type": "select",
      "id": "highlighted_scribble",
      "options": [
        {
          "value": "circle",
          "label": "t:sections.global.settings.highlighted_scribble.options__1.label"
        },
        {
          "value": "basic-underline",
          "label": "t:sections.global.settings.highlighted_scribble.options__2.label"
        },
        {
          "value": "sketch-underline",
          "label": "t:sections.global.settings.highlighted_scribble.options__3.label"
        },
        {
          "value": "squiggle-underline",
          "label": "t:sections.global.settings.highlighted_scribble.options__4.label"
        },
        {
          "value": "squiggle-underline-2",
          "label": "t:sections.global.settings.highlighted_scribble.options__5.label"
        }
      ],
      "default": "circle",
      "label": "t:sections.global.settings.highlighted_scribble.label",
      "info": "t:sections.global.settings.highlighted_scribble.info"
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header__colors.content",
      "info": "t:sections.global.settings.header__colors.info"
    },
    {
      "type": "color",
      "id": "color_text",
      "label": "t:sections.global.settings.color_text.label"
    },
    {
      "type": "color",
      "id": "color_background",
      "label": "t:sections.global.settings.color_background.label"
    },
    {
      "type": "color_background",
      "id": "gradient_background",
      "label": "t:sections.global.settings.gradient_background.label"
    },
    {
      "type": "color",
      "id": "color_highlight",
      "label": "t:sections.global.settings.color_highlight.label"
    },
    {
      "type": "color_background",
      "id": "gradient_highlight",
      "label": "t:sections.global.settings.gradient_highlight.label"
    },
    {
      "type": "color",
      "id": "color_button_text",
      "label": "t:sections.global.settings.color_button_text.label"
    },
    {
      "type": "color",
      "id": "color_button_background",
      "label": "t:sections.global.settings.color_button_background.label"
    },
    {
      "type": "color_background",
      "id": "color_button_gradient",
      "label": "t:sections.global.settings.color_button_gradient.label"
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header__section.content"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.global.settings.padding_top.label",
      "default": 72
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.global.settings.padding_bottom.label",
      "default": 72
    },
    {
      "type": "checkbox",
      "id": "divider",
      "label": "t:sections.global.settings.divider.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "t:sections.global.settings.full_width.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "rounded",
      "default": false,
      "label": "t:sections.global.settings.rounded.label"
    }, 
    {
      "type": "range", 
      "id": "gap", 
      "label": "Gap (Desktop)", 
      "min": 0, 
      "max": 72, 
      "step": 1, 
      "unit": "px", 
      "default": 30
    }, 
    {
      "type": "range", 
      "id": "gap_mobile", 
      "label": "Gap (Mobile)", 
      "min": 0, 
      "max": 72, 
      "step": 1, 
      "unit": "px", 
      "default": 8
    }, 
    {
      "type": "header", 
      "content": "Article card"
    }, 
    {
      "type": "color", 
      "id": "card_bg", 
      "label": "Background color", 
      "default": "#FAF9F4"
    },
    {
      "type": "range", 
      "id": "card_radius", 
      "label": "Border radius", 
      "min": 0, 
      "max": 72, 
      "step": 1, 
      "unit": "px", 
      "default": 20
    }, 
    {
      "type": "range", 
      "id": "card_padding", 
      "label": "Padding", 
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px", 
      "default": 20
    }, 
    {
      "type": "range", 
      "id": "image_radius", 
      "label": "Image border radius", 
      "min": 0, 
      "max": 72, 
      "step": 1, 
      "unit": "px", 
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "CG Blog Posts Collage",
      "settings": {
        "blog": "",
        "post_limit": 3
      }
    }
  ]
}
{% endschema %}
