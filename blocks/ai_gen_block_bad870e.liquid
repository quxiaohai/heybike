{% doc %}
  @prompt
    Create a horizontal scrollable navigation bar with swipeable tabs for products: Ranger 3.0 Pro, Mars 3.0, Ranger S, Mars 2.0, Horizon, Cityrun. When tabs exceed screen width, enable horizontal swiping with scroll indicators. Below each product section, display 6 YouTube videos in a 3x2 grid layout (3 videos per row, 2 rows). Videos should open in popup/modal overlay when clicked, not inline. Add a styled "View Product" button with hover effects next to each product's tab label that links to the product page. Include smooth scrolling between sections and active tab highlighting.

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-product-nav-{{ ai_gen_id }} {
    width: 100%;
    background-color: {{ block.settings.nav_background_color }};
    border-bottom: 1px solid {{ block.settings.border_color }};
    position: sticky;
    top: 0;
    z-index: 10;
  }

  .ai-product-nav-container-{{ ai_gen_id }} {
    position: relative;
    max-width: 100%;
    overflow: hidden;
  }

  .ai-product-nav-scroll-{{ ai_gen_id }} {
    display: flex;
    overflow-x: auto;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    padding: 0 20px;
  }

  .ai-product-nav-scroll-{{ ai_gen_id }}::-webkit-scrollbar {
    display: none;
  }

  .ai-product-nav-item-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px 24px;
    white-space: nowrap;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
    color: {{ block.settings.tab_text_color }};
    font-size: {{ block.settings.tab_font_size }}px;
    font-weight: 500;
  }

  .ai-product-nav-item-{{ ai_gen_id }}.active {
    border-bottom-color: {{ block.settings.active_tab_color }};
    color: {{ block.settings.active_tab_color }};
  }

  .ai-product-nav-item-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.tab_hover_color }};
  }

  .ai-product-view-btn-{{ ai_gen_id }} {
    padding: 8px 16px;
    background-color: {{ block.settings.button_color }};
    color: {{ block.settings.button_text_color }};
    border: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-size: 14px;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .ai-product-view-btn-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_color }};transform: translateY(-2px);box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .ai-scroll-indicator-{{ ai_gen_id }} {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: {{ block.settings.indicator_color }};
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    transition: opacity 0.3s ease;
    z-index: 2;
  }

  .ai-scroll-indicator-{{ ai_gen_id }}:hover {
    opacity: 1;
  }

  .ai-scroll-indicator-{{ ai_gen_id }}.left {
    left: 10px;
  }

  .ai-scroll-indicator-{{ ai_gen_id }}.right {
    right: 10px;
  }

  .ai-scroll-indicator-{{ ai_gen_id }}.hidden {
    opacity: 0;pointer-events: none;
  }

  .ai-product-section-{{ ai_gen_id }} {
    padding: 40px 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .ai-product-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.section_title_size }}px;
    font-weight: 700;
    margin-bottom: 30px;
    color: {{ block.settings.section_title_color }};
    text-align: center;
  }

  .ai-video-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-bottom: 40px;
  }

  .ai-video-item-{{ ai_gen_id }} {
    position: relative;
    aspect-ratio: 16/9;
    background-color: {{ block.settings.video_placeholder_color }};
    border-radius: {{ block.settings.video_border_radius }}px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .ai-video-item-{{ ai_gen_id }}:hover {
    transform: scale(1.05);
  }

  .ai-video-thumbnail-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-video-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: {{ block.settings.video_placeholder_color }};
    color: {{ block.settings.placeholder_text_color }};
    font-size: 14px;
  }

  .ai-video-play-btn-{{ ai_gen_id }} {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .ai-video-play-btn-{{ ai_gen_id }}:hover {
    background-color: rgba(0, 0, 0, 0.9);
    transform: translate(-50%, -50%) scale(1.1);
  }

  .ai-video-modal-{{ ai_gen_id }} {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .ai-video-modal-{{ ai_gen_id }}.active {
    opacity: 1;
    visibility: visible;
  }

  .ai-video-modal-content-{{ ai_gen_id }} {
    position: relative;
    width: 90%;
    max-width: 800px;
    aspect-ratio: 16/9;
    background-color: black;
    border-radius: 8px;
    overflow: hidden;}

  .ai-video-modal-close-{{ ai_gen_id }} {
    position: absolute;
    top: -40px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 8px;
    z-index: 1001;
  }

  .ai-video-iframe-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    border: none;
  }

  @media screen and (max-width: 768px) {
    .ai-video-grid-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }

    .ai-product-nav-item-{{ ai_gen_id }} {
      padding: 12px 16px;
      font-size: 14px;
    }

    .ai-product-view-btn-{{ ai_gen_id }} {
      padding: 6px 12px;
      font-size: 12px;
    }

    .ai-product-section-{{ ai_gen_id }} {
      padding: 30px 15px;
    }
  }

  @media screen and (max-width: 480px) {
    .ai-video-grid-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
    }

    .ai-product-nav-item-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 8px;
      padding: 12px;
    }
  }
{% endstyle %}

<product-navigation-{{ ai_gen_id }} class="ai-product-nav-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-product-nav-container-{{ ai_gen_id }}">
    <button class="ai-scroll-indicator-{{ ai_gen_id }} left hidden" aria-label="Scroll left">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15,18 9,12 15,6"></polyline>
      </svg>
    </button>
    
    <div class="ai-product-nav-scroll-{{ ai_gen_id }}">
      {% assign products = 'Ranger 3.0 Pro,Mars 3.0,Ranger S,Mars 2.0,Horizon,Cityrun' | split: ',' %}
      {% for product_name in products %}
        {% assign product_slug = product_name | handleize %}
        <div class="ai-product-nav-item-{{ ai_gen_id }} {% if forloop.first %}active{% endif %}" data-target="{{ product_slug }}">
          <span>{{ product_name }}</span><a href="/products/{{ product_slug }}" class="ai-product-view-btn-{{ ai_gen_id }}">View Product</a>
        </div>
      {% endfor %}
    </div>

    <button class="ai-scroll-indicator-{{ ai_gen_id }} right" aria-label="Scroll right">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9,18 15,12 9,6"></polyline>
      </svg>
    </button>
  </div>
</product-navigation-{{ ai_gen_id }}>

<div class="ai-product-sections-{{ ai_gen_id }}">
  {% for product_name in products %}
    {% assign product_slug = product_name | handleize %}
    <div class="ai-product-section-{{ ai_gen_id }}" id="section-{{ product_slug }}" data-section="{{ product_slug }}">
      <h2 class="ai-product-title-{{ ai_gen_id }}">{{ product_name }} Videos</h2>
      
      <div class="ai-video-grid-{{ ai_gen_id }}">
        {% for i in (1..6) %}
          {% assign video_url_key = 'video_' | append: product_slug | append: '_' | append: i %}
          {% assign video_url = block.settings[video_url_key] %}
          <div class="ai-video-item-{{ ai_gen_id }}" data-video-url="{{ video_url }}">
            {% if video_url != blank %}
              {% assign video_id = video_url | split: 'v=' | last | split: '&' | first %}
              {% if video_id == video_url %}
                {% assign video_id = video_url | split: '/' | last %}{% endif %}
              <img 
                src="https://img.youtube.com/vi/{{ video_id }}/maxresdefault.jpg" 
                alt="Video thumbnail"
                class="ai-video-thumbnail-{{ ai_gen_id }}"
                loading="lazy"
              >
            {% else %}
              <div class="ai-video-placeholder-{{ ai_gen_id }}">
                Add YouTube URL
              </div>
            {% endif %}
            
            {% if video_url != blank %}
              <button class="ai-video-play-btn-{{ ai_gen_id }}" aria-label="Play video">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                  <polygon points="5,3 19,12 5,21"></polygon>
                </svg>
              </button>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
</div>

<div class="ai-video-modal-{{ ai_gen_id }}">
  <div class="ai-video-modal-content-{{ ai_gen_id }}">
    <button class="ai-video-modal-close-{{ ai_gen_id }}" aria-label="Close video">×</button>
    <iframe class="ai-video-iframe-{{ ai_gen_id }}" src="" allowfullscreen></iframe>
  </div>
</div>

<script>
  (function() {
    class ProductNavigation{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.navScroll = this.querySelector('.ai-product-nav-scroll-{{ ai_gen_id }}');
        this.navItems = this.querySelectorAll('.ai-product-nav-item-{{ ai_gen_id }}');
        this.leftIndicator = this.querySelector('.ai-scroll-indicator-{{ ai_gen_id }}.left');
        this.rightIndicator = this.querySelector('.ai-scroll-indicator-{{ ai_gen_id }}.right');
        this.sections = document.querySelectorAll('.ai-product-section-{{ ai_gen_id }}');
        this.videoItems = document.querySelectorAll('.ai-video-item-{{ ai_gen_id }}');
        this.modal = document.querySelector('.ai-video-modal-{{ ai_gen_id }}');
        this.modalIframe = document.querySelector('.ai-video-iframe-{{ ai_gen_id }}');
        this.modalClose = document.querySelector('.ai-video-modal-close-{{ ai_gen_id }}');
      }

      connectedCallback() {
        this.setupNavigation();
        this.setupScrollIndicators();
        this.setupVideoModal();
        this.updateScrollIndicators();
      }

      setupNavigation() {
        this.navItems.forEach((item, index) => {
          item.addEventListener('click', (e) => {
            if (e.target.closest('.ai-product-view-btn-{{ ai_gen_id }}')) {
              return;
            }
            
            e.preventDefault();
            const target = item.dataset.target;
            const section = document.getElementById(`section-${target}`);
            
            this.navItems.forEach(navItem => navItem.classList.remove('active'));
            item.classList.add('active');
            
            if (section) {
              section.scrollIntoView({ behavior: 'smooth' });
            }
          });
        });

        window.addEventListener('scroll', () => {
          this.updateActiveTab();
        });
      }

      setupScrollIndicators() {
        this.leftIndicator.addEventListener('click', () => {
          this.navScroll.scrollBy({ left: -200, behavior: 'smooth' });
        });

        this.rightIndicator.addEventListener('click', () => {
          this.navScroll.scrollBy({ left: 200, behavior: 'smooth' });
        });

        this.navScroll.addEventListener('scroll', () => {
          this.updateScrollIndicators();
        });
      }

      setupVideoModal() {
        this.videoItems.forEach(item => {
          item.addEventListener('click', () => {
            const videoUrl = item.dataset.videoUrl;
            if (videoUrl) {
              this.openVideoModal(videoUrl);
            }
          });
        });

        this.modalClose.addEventListener('click', () => {
          this.closeVideoModal();
        });

        this.modal.addEventListener('click', (e) => {
          if (e.target === this.modal) {
            this.closeVideoModal();
          }
        });document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            this.closeVideoModal();
          }
        });
      }

      openVideoModal(videoUrl) {
        let embedUrl = '';
        if (videoUrl.includes('youtube.com/watch?v=')) {
          const videoId = videoUrl.split('v=')[1].split('&')[0];
          embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
        } else if (videoUrl.includes('youtu.be/')) {
          const videoId = videoUrl.split('/').pop();
          embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
        }

        if (embedUrl) {
          this.modalIframe.src = embedUrl;
          this.modal.classList.add('active');document.body.style.overflow = 'hidden';
        }
      }

      closeVideoModal() {
        this.modal.classList.remove('active');
        this.modalIframe.src = '';
        document.body.style.overflow = '';
      }

      updateScrollIndicators() {
        const scrollLeft = this.navScroll.scrollLeft;
        const scrollWidth = this.navScroll.scrollWidth;
        const clientWidth = this.navScroll.clientWidth;

        this.leftIndicator.classList.toggle('hidden', scrollLeft <= 0);
        this.rightIndicator.classList.toggle('hidden', scrollLeft >= scrollWidth - clientWidth - 1);
      }

      updateActiveTab() {
        const scrollY = window.scrollY;
        let currentSection = '';

        this.sections.forEach(section => {
          const sectionTop = section.offsetTop - 100;
          const sectionHeight = section.offsetHeight;
          
          if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
            currentSection = section.dataset.section;
          }
        });

        if (currentSection) {
          this.navItems.forEach(item => {
            item.classList.toggle('active', item.dataset.target === currentSection);
          });
        }
      }
    }

    customElements.define('product-navigation-{{ ai_gen_id }}', ProductNavigation{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Product video navigation",
  "settings": [
    {
      "type": "header",
      "content": "Navigation style"
    },
    {
      "type": "color",
      "id": "nav_background_color",
      "label": "Navigation background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#e5e5e5"
    },
    {
      "type": "color",
      "id": "tab_text_color",
      "label": "Tab text color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "active_tab_color",
      "label": "Active tab color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "tab_hover_color",
      "label": "Tab hover background",
      "default": "#f5f5f5"
    },
    {
      "type": "range",
      "id": "tab_font_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Tab font size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Button style"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button hover background",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 6
    },
    {
      "type": "header",
      "content": "Scroll indicators"
    },
    {
      "type": "color",
      "id": "indicator_color",
      "label": "Indicator color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Section style"
    },
    {
      "type": "color",
      "id": "section_title_color",
      "label": "Section title color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "section_title_size",
      "min": 20,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Section title size",
      "default": 28
    },
    {
      "type": "header",
      "content": "Video style"
    },
    {
      "type": "color",
      "id": "video_placeholder_color",
      "label": "Video placeholder background",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "placeholder_text_color",
      "label": "Placeholder text color",
      "default": "#999999"
    },
    {
      "type": "range",
      "id": "video_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Video border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Ranger 3.0 Pro videos"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_3_0_pro_6",
      "label": "Video 6 URL"
    },
    {
      "type": "header",
      "content": "Mars 3.0 videos"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_mars_3_0_6",
      "label": "Video 6 URL"
    },
    {
      "type": "header",
      "content": "Ranger S videos"
    },
    {
      "type": "text",
      "id": "video_ranger_s_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_s_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_s_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_s_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_s_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_ranger_s_6",
      "label": "Video 6 URL"
    },
    {
      "type": "header",
      "content": "Mars 2.0 videos"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_mars_2_0_6",
      "label": "Video 6 URL"
    },
    {
      "type": "header",
      "content": "Horizon videos"
    },
    {
      "type": "text",
      "id": "video_horizon_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_horizon_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_horizon_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_horizon_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_horizon_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_horizon_6",
      "label": "Video 6 URL"
    },
    {
      "type": "header",
      "content": "Cityrun videos"
    },
    {
      "type": "text",
      "id": "video_cityrun_1",
      "label": "Video 1 URL"
    },
    {
      "type": "text",
      "id": "video_cityrun_2",
      "label": "Video 2 URL"
    },
    {
      "type": "text",
      "id": "video_cityrun_3",
      "label": "Video 3 URL"
    },
    {
      "type": "text",
      "id": "video_cityrun_4",
      "label": "Video 4 URL"
    },
    {
      "type": "text",
      "id": "video_cityrun_5",
      "label": "Video 5 URL"
    },
    {
      "type": "text",
      "id": "video_cityrun_6",
      "label": "Video 6 URL"
    }
  ],
  "presets": [
    {
      "name": "Product video navigation"
    }
  ]
}
{% endschema %}